<!DOCTYPE html>
<html lang="nl" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">
    <title>Reservatie detail | Art Equipment Rental</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">
</head>
<body>

<header class="topbar">
    <div class="topbar-inner">
        <div class="brand">
            <div class="logo"></div>
            <div>
                Art Equipment Rental
                <small>Reservatie detail</small>
            </div>
        </div>

        <nav class="nav">
            <a th:href="@{/products}">Catalogus</a>
            <a th:href="@{/orders}" class="active">Mijn reservaties</a>
            <a th:href="@{/logout}">Logout</a>
        </nav>
    </div>
</header>

<main class="container">

    <div class="page-head">
        <div class="order-success">
            ✅ Reservatie succesvol bevestigd
        </div>

        <p>
            Periode:
            <strong>
                <span th:text="${#temporals.format(order.startDate, 'dd/MM/yyyy')}"></span>
                →
                <span th:text="${#temporals.format(order.endDate, 'dd/MM/yyyy')}"></span>
            </strong>
        </p>


        <span th:switch="${order.status}">
            <span th:case="'BEVESTIGD'" class="status-badge status-confirmed">
                Bevestigd
            </span>
            <span th:case="'OPGEHAALD'" class="status-badge status-active">
                Opgehaald
            </span>
            <span th:case="'TERUGGEBRACHT'" class="status-badge status-done">
                Teruggebracht
            </span>
            <span th:case="*" class="status-badge status-default">
                <span th:text="${order.status}"></span>
            </span>
        </span>
    </div>

    <div class="list order-detail">

        <div class="card item order-item"
             th:each="item : ${order.items}"
             th:if="${order.items != null}">

            <div class="item-line">
                <div>
                    <strong th:text="${item.product.name}"></strong>
                    <div class="muted" style="font-size:13px;">
                        <span th:text="${item.quantity}"></span> stuk(s) ·
                        <span th:text="${item.days}"></span> dag(en) ·
                        € <span th:text="${item.product.pricePerDay}"></span> / dag
                    </div>
                </div>

                <strong>
                    € <span th:text="${item.subtotal}"></span>
                </strong>
            </div>
        </div>

        <div class="card item order-total">
            <div class="item-line">
                <strong>Totaal te betalen</strong>
                <strong style="font-size:20px;">
                    € <span th:text="${order.totalPrice}"></span>
                </strong>
            </div>
        </div>

    </div>

    <div class="actions">
        <a th:href="@{/orders}" class="btn-ghost">← Terug naar overzicht</a>
    </div>

    <div class="actions">
        <div sec:authorize="hasRole('ADMIN')">
    </div>


        <form th:if="${order.status == 'BEVESTIGD'}"
              th:action="@{/orders/{id}/pickup(id=${order.id})}"
              method="post">
            <button class="btn btn-secondary">
                Markeer als opgehaald
            </button>
        </form>

        <form th:if="${order.status == 'OPGEHAALD'}"
              th:action="@{/orders/{id}/return(id=${order.id})}"
              method="post">
            <button class="btn">
                Markeer als teruggebracht
            </button>
        </form>

    </div>

</main>

</body>
</html>
